import{useToggle as w}from"@vueuse/core";import{computed as m,defineComponent as L,h as e}from"vue";import{u as p,V as O}from"./VPHeader-md6pz3tm.js";import"./styles/vars.css";import"./styles/changelog.css";import{usePageFrontmatter as k,usePageLang as h,usePageData as u}from"vuepress/client";import{isLinkHttp as C}from"@vuepress/helper/client";const v=__GIT_OPTIONS__,I=(a,n)=>!a||C(a)?a:n==="github"?`https://github.com/${a}`:n==="gitee"?`https://gitee.com/${a}`:a,T=/#(\d+)/g,d=()=>{const a=k(),n=h(),r=u(),{pattern:s={},provider:i}=v,l=I(v.repo,i);return m(()=>{if(a.value.changelog===!1)return[];const c=new Intl.DateTimeFormat(n.value,{dateStyle:"short"});return(r.value.git?.changelog??[]).map(g=>{const o={date:c.format(g.time),...g};return s.issue&&l&&(o.message=o.message.replace(T,(t,S)=>`<a href="${s.issue.replace(":issue",S).replace(":repo",l)}" target="_blank" rel="noopener noreferrer">${t}</a>`)),s.commit&&l&&(o.commitUrl=s.commit.replace(":hash",o.hash).replace(":repo",l)),s.tag&&l&&o.tag&&(o.tagUrl=s.tag.replace(":tag",o.tag).replace(":repo",l)),o})})},f=()=>{const a=h(),n=p(),r=u();return m(()=>{const s=r.value.git?.updatedTime??r.value.git?.changelog?.[0].time;if(!s)return null;const i=new Date(s),l=new Intl.DateTimeFormat(a.value,{dateStyle:"short",timeStyle:"short"}).format(s);return{date:i,iso:i.toISOString(),text:`${n.value.latestUpdateAt} ${l}`}})},_=L({name:"GitChangelog",props:{title:String,headerLevel:{type:Number,default:2}},setup(a){const n=d(),r=p(),s=f(),[i,l]=w(),c=()=>e("div",{class:"vp-changelog-header",onClick:()=>l()},[e("div",{class:"vp-latest-updated"},[e("span",{class:"vp-changelog-icon"}),e("span",{"data-allow-mismatch":""},s.value.text)]),e("div",[e("span",{class:"vp-changelog-menu-icon"}),e("span",r.value.viewChangelog)])]),g=({item:t})=>e("li",{class:"vp-changelog-item-tag"},e("div",[e("a",{class:"vp-changelog-tag"},e("code",t.tag)),e("span",{class:"vp-changelog-date","data-allow-mismatch":""},[r.value.timeOn," ",e("time",{datetime:new Date(t.time).toISOString()},t.date)])])),o=({item:t})=>e("li",{class:"vp-changelog-item-commit"},[e(t.commitUrl?"a":"span",{class:"vp-changelog-hash",href:t.commitUrl,target:"_blank",rel:"noreferrer"},[e("code",t.hash.slice(0,5))]),e("span",{class:"vp-changelog-divider"},"-"),e("span",{class:"vp-changelog-message",innerHTML:t.message}),e("span",{class:"vp-changelog-date","data-allow-mismatch":""},[r.value.timeOn||"on"," ",e("time",{datetime:new Date(t.time).toISOString()},t.date)])]);return()=>n.value.length?[e(O,{level:a.headerLevel,anchor:"doc-changelog",text:a.title||r.value.changelog}),e("div",{class:["vp-changelog-wrapper",{active:i.value}]},[e(c),e("ul",{class:"vp-changelog-list"},[n.value.map(t=>t.tag?e(g,{item:t,key:t.tag}):e(o,{item:t,key:t.hash}))])])]:null}});export{_ as G,f as a,d as u};
//# sourceMappingURL=GitChangelog-CsL-dNIZ.js.map
